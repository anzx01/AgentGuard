(()=>{var e={};e.id=481,e.ids=[481],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},8783:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>h,originalPathname:()=>x,pages:()=>c,routeModule:()=>g,tree:()=>d}),s(1872),s(4341),s(7718),s(7824);var a=s(3282),r=s(5736),l=s(3906),n=s.n(l),o=s(6880),i={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>o[e]);s.d(t,i);let d=["",{children:["dashboard",{children:["logs",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,1872)),"G:\\myaist\\AgentGuard\\packages\\dashboard\\src\\app\\dashboard\\logs\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,4341)),"G:\\myaist\\AgentGuard\\packages\\dashboard\\src\\app\\dashboard\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,7718)),"G:\\myaist\\AgentGuard\\packages\\dashboard\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,7824,23)),"next/dist/client/components/not-found-error"]}],c=["G:\\myaist\\AgentGuard\\packages\\dashboard\\src\\app\\dashboard\\logs\\page.tsx"],x="/dashboard/logs/page",h={require:s,loadChunk:()=>Promise.resolve()},g=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/dashboard/logs/page",pathname:"/dashboard/logs",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},4224:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,4424,23)),Promise.resolve().then(s.t.bind(s,7752,23)),Promise.resolve().then(s.t.bind(s,5275,23)),Promise.resolve().then(s.t.bind(s,9842,23)),Promise.resolve().then(s.t.bind(s,1633,23)),Promise.resolve().then(s.t.bind(s,9224,23))},7578:(e,t,s)=>{Promise.resolve().then(s.bind(s,1660))},8144:()=>{},2684:(e,t,s)=>{Promise.resolve().then(s.bind(s,1394)),Promise.resolve().then(s.bind(s,8946))},1660:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});var a=s(3227),r=s(3677),l=s(7674);function n(){let[e,t]=(0,r.useState)([]),[s,n]=(0,r.useState)(0),[i,d]=(0,r.useState)(1),[c,x]=(0,r.useState)({status:"",service:"",q:""}),[h,g]=(0,r.useState)(null);async function m(){let e=new URLSearchParams({page:String(i),pageSize:String(50),...c.status&&{status:c.status},...c.service&&{service:c.service},...c.q&&{q:c.q}}),s=await (0,l.SC)(`/logs?${e}`);t(s.data),n(s.total)}let u=e=>"allow"===e?"text-green-400":"block"===e?"text-red-400":"text-orange-400";return(0,a.jsxs)("div",{className:"space-y-4",children:[a.jsx("h1",{className:"text-xl font-semibold text-white",children:"实时日志"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,a.jsxs)("select",{value:c.status,onChange:e=>{x(t=>({...t,status:e.target.value})),d(1)},className:"bg-gray-800 border border-gray-700 rounded-lg px-3 py-1.5 text-sm text-gray-300 focus:outline-none",children:[a.jsx("option",{value:"",children:"全部状态"}),a.jsx("option",{value:"allow",children:"通过"}),a.jsx("option",{value:"block",children:"阻断"}),a.jsx("option",{value:"error",children:"错误"})]}),a.jsx("input",{value:c.service,onChange:e=>{x(t=>({...t,service:e.target.value})),d(1)},placeholder:"服务名称...",className:"bg-gray-800 border border-gray-700 rounded-lg px-3 py-1.5 text-sm text-gray-300 focus:outline-none w-36"}),a.jsx("input",{value:c.q,onChange:e=>{x(t=>({...t,q:e.target.value})),d(1)},placeholder:"搜索 URL 或 Agent...",className:"bg-gray-800 border border-gray-700 rounded-lg px-3 py-1.5 text-sm text-gray-300 focus:outline-none w-56"}),a.jsx("button",{onClick:m,className:"bg-gray-800 hover:bg-gray-700 text-gray-300 px-3 py-1.5 rounded-lg text-sm",children:"刷新"}),(0,a.jsxs)("span",{className:"text-gray-500 text-sm self-center",children:["共 ",s," 条"]})]}),a.jsx("div",{className:"bg-gray-900 border border-gray-800 rounded-xl overflow-hidden",children:(0,a.jsxs)("div",{className:"overflow-x-auto",children:[(0,a.jsxs)("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:(0,a.jsxs)("tr",{className:"text-gray-500 text-xs border-b border-gray-800 bg-gray-900/80",children:[a.jsx("th",{className:"text-left px-4 py-3 font-normal",children:"时间"}),a.jsx("th",{className:"text-left px-4 py-3 font-normal",children:"Agent"}),a.jsx("th",{className:"text-left px-4 py-3 font-normal",children:"服务"}),a.jsx("th",{className:"text-left px-4 py-3 font-normal",children:"方法"}),a.jsx("th",{className:"text-left px-4 py-3 font-normal",children:"状态"}),a.jsx("th",{className:"text-right px-4 py-3 font-normal",children:"延迟"}),a.jsx("th",{className:"text-right px-4 py-3 font-normal",children:"费用"}),a.jsx("th",{className:"text-right px-4 py-3 font-normal",children:"操作"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-800",children:e.map(e=>(0,a.jsxs)("tr",{className:`hover:bg-gray-800/50 ${"block"===e.decision?"bg-red-950/10":""}`,children:[a.jsx("td",{className:"px-4 py-2.5 text-gray-500 text-xs whitespace-nowrap",children:new Date(e.timestamp).toLocaleTimeString()}),a.jsx("td",{className:"px-4 py-2.5 text-gray-300",children:e.agent_name??"-"}),a.jsx("td",{className:"px-4 py-2.5 text-gray-300",children:e.target_service}),a.jsx("td",{className:"px-4 py-2.5 text-gray-400 text-xs",children:e.method}),a.jsx("td",{className:"px-4 py-2.5",children:a.jsx("span",{className:`text-xs font-medium ${u(e.decision)}`,children:"allow"===e.decision?"✓ 通过":"block"===e.decision?"✗ 阻断":"⚠ 错误"})}),a.jsx("td",{className:"px-4 py-2.5 text-right text-gray-500 text-xs",children:null!=e.latency_ms?`${e.latency_ms.toFixed(0)}ms`:"-"}),a.jsx("td",{className:"px-4 py-2.5 text-right text-gray-400 text-xs",children:e.estimated_cost>0?`$${e.estimated_cost.toFixed(3)}`:"-"}),a.jsx("td",{className:"px-4 py-2.5 text-right",children:a.jsx("button",{onClick:()=>g(e),className:"text-xs text-blue-400 hover:text-blue-300",children:"详情"})})]},e.id))})]}),0===e.length&&a.jsx("p",{className:"text-center text-gray-500 py-10",children:"暂无日志记录"})]})}),s>50&&(0,a.jsxs)("div",{className:"flex items-center justify-center gap-3",children:[a.jsx("button",{onClick:()=>d(e=>Math.max(1,e-1)),disabled:1===i,className:"px-3 py-1 rounded bg-gray-800 text-gray-300 text-sm disabled:opacity-40",children:"上一页"}),(0,a.jsxs)("span",{className:"text-gray-400 text-sm",children:["第 ",i," 页 / 共 ",Math.ceil(s/50)," 页"]}),a.jsx("button",{onClick:()=>d(e=>e+1),disabled:i>=Math.ceil(s/50),className:"px-3 py-1 rounded bg-gray-800 text-gray-300 text-sm disabled:opacity-40",children:"下一页"})]}),h&&(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex justify-end",children:[a.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>g(null)}),(0,a.jsxs)("div",{className:"relative w-full max-w-md bg-gray-900 border-l border-gray-800 h-full overflow-y-auto p-6 space-y-5",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("h2",{className:"font-semibold text-white",children:"请求详情"}),a.jsx("button",{onClick:()=>g(null),className:"text-gray-400 hover:text-white text-xl",children:"\xd7"})]}),(0,a.jsxs)("div",{className:"space-y-3 text-sm",children:[a.jsx(o,{label:"事务 ID",value:h.id,mono:!0}),a.jsx(o,{label:"时间",value:new Date(h.timestamp).toLocaleString()}),a.jsx(o,{label:"Agent",value:h.agent_name??"-"}),a.jsx(o,{label:"目标服务",value:h.target_service}),a.jsx(o,{label:"目标 URL",value:h.target_url,mono:!0}),a.jsx(o,{label:"方法",value:h.method}),a.jsx(o,{label:"响应状态",value:h.response_status?String(h.response_status):"-"}),a.jsx(o,{label:"延迟",value:null!=h.latency_ms?`${h.latency_ms.toFixed(1)}ms`:"-"}),a.jsx(o,{label:"预估费用",value:h.estimated_cost>0?`$${h.estimated_cost.toFixed(4)}`:"-"}),(0,a.jsxs)("div",{className:"border-t border-gray-800 pt-3",children:[a.jsx("p",{className:"text-gray-500 text-xs mb-2",children:"决策信息"}),a.jsx(o,{label:"决策",value:"allow"===h.decision?"✓ 通过":"✗ 阻断",valueClass:"allow"===h.decision?"text-green-400":"text-red-400"}),h.block_reason&&a.jsx(o,{label:"阻断原因",value:h.block_reason})]})]})]})]})]})}function o({label:e,value:t,mono:s,valueClass:r}){return(0,a.jsxs)("div",{className:"flex gap-3",children:[a.jsx("span",{className:"text-gray-500 w-24 shrink-0",children:e}),a.jsx("span",{className:`text-gray-200 break-all ${s?"font-mono text-xs":""} ${r??""}`,children:t})]})}},1394:(e,t,s)=>{"use strict";s.d(t,{default:()=>d});var a=s(3227),r=s(649),l=s(1043),n=s(7674),o=s(1126);let i=[{href:"/dashboard",label:"总览",icon:"◉"},{href:"/dashboard/agents",label:"Agent",icon:"⬡"},{href:"/dashboard/rules",label:"规则",icon:"⚙"},{href:"/dashboard/logs",label:"日志",icon:"≡"},{href:"/dashboard/alerts",label:"告警",icon:"⚠"},{href:"/dashboard/settings",label:"设置",icon:"⊙"}];function d(){let e=(0,l.usePathname)();return(0,a.jsxs)("aside",{className:"w-52 shrink-0 bg-gray-900 border-r border-gray-800 flex flex-col min-h-screen",children:[(0,a.jsxs)("div",{className:"px-4 py-5 border-b border-gray-800",children:[a.jsx("span",{className:"font-bold text-white text-lg",children:"AgentGuard"}),a.jsx("span",{className:"ml-2 text-xs text-gray-500",children:"v1.0"})]}),a.jsx("nav",{className:"flex-1 py-4 space-y-1 px-2",children:i.map(t=>(0,a.jsxs)(r.default,{href:t.href,className:(0,o.Z)("flex items-center gap-3 px-3 py-2 rounded-lg text-sm transition-colors",e===t.href?"bg-blue-600 text-white":"text-gray-400 hover:text-white hover:bg-gray-800"),children:[a.jsx("span",{children:t.icon}),a.jsx("span",{children:t.label})]},t.href))}),a.jsx("div",{className:"p-4 border-t border-gray-800",children:a.jsx("button",{onClick:n.kS,className:"w-full text-left text-xs text-gray-500 hover:text-gray-300 transition-colors",children:"退出登录"})})]})}},8946:(e,t,s)=>{"use strict";s.d(t,{default:()=>n});var a=s(3227),r=s(3677),l=s(7674);function n(){let[e,t]=(0,r.useState)({global:{paused:!1}}),[s,n]=(0,r.useState)(!1);async function o(){if(e.global.paused)await (0,l.SC)("/kill-switch/deactivate",{method:"POST",body:JSON.stringify({scope:"global"})}),t({global:{paused:!1}});else{if(!s){n(!0);return}await (0,l.SC)("/kill-switch/activate",{method:"POST",body:JSON.stringify({reason:"手动触发",scope:"global"})}),t({global:{paused:!0}}),n(!1)}}return(0,a.jsxs)("header",{className:"h-14 bg-gray-900 border-b border-gray-800 flex items-center justify-between px-6 shrink-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:`w-2 h-2 rounded-full ${e.global.paused?"bg-red-500":"bg-green-500"}`}),a.jsx("span",{className:"text-sm text-gray-400",children:e.global.paused?"已暂停":"运行中"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[s&&a.jsx("span",{className:"text-xs text-yellow-400",children:"再次点击确认暂停所有请求"}),a.jsx("button",{onClick:o,onBlur:()=>n(!1),className:`px-4 py-1.5 rounded-lg text-sm font-medium transition-colors ${e.global.paused?"bg-green-700 hover:bg-green-600 text-white":s?"bg-red-500 hover:bg-red-400 text-white":"bg-red-900 hover:bg-red-800 text-red-300"}`,children:e.global.paused?"▶ 恢复服务":"■ Kill Switch"})]})]})}},7674:(e,t,s)=>{"use strict";s.d(t,{SC:()=>r,kS:()=>l});let a=process.env.NEXT_PUBLIC_API_URL||"/api";async function r(e,t){let s=await fetch(`${a}${e}`,{...t,headers:{"Content-Type":"application/json",...t?.headers}});if(401===s.status)throw Error("Unauthorized");if(!s.ok)throw Error((await s.json().catch(()=>({}))).message||`HTTP ${s.status}`);return s.json()}function l(){localStorage.removeItem("ag_token"),window.location.href="/login"}},4341:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var a=s(9013),r=s(3189);let l=(0,r.createProxy)(String.raw`G:\myaist\AgentGuard\packages\dashboard\src\components\Sidebar.tsx#default`),n=(0,r.createProxy)(String.raw`G:\myaist\AgentGuard\packages\dashboard\src\components\TopBar.tsx#default`);function o({children:e}){return(0,a.jsxs)("div",{className:"flex h-screen overflow-hidden",children:[a.jsx(l,{}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[a.jsx(n,{}),a.jsx("main",{className:"flex-1 overflow-y-auto p-6 bg-gray-950",children:e})]})]})}},1872:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(3189).createProxy)(String.raw`G:\myaist\AgentGuard\packages\dashboard\src\app\dashboard\logs\page.tsx#default`)},7718:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l,metadata:()=>r});var a=s(9013);s(5556);let r={title:"AgentGuard",description:"AI Agent API 安全代理网关"};function l({children:e}){return a.jsx("html",{lang:"zh-CN",children:a.jsx("body",{className:"bg-gray-950 text-gray-100 min-h-screen",children:e})})}},5556:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[592,914],()=>s(8783));module.exports=a})();