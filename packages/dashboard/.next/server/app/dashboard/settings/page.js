(()=>{var e={};e.id=455,e.ids=[455],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6938:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>g,originalPathname:()=>x,pages:()=>c,routeModule:()=>u,tree:()=>d}),s(1762),s(4341),s(7718),s(7824);var a=s(3282),r=s(5736),n=s(3906),l=s.n(n),i=s(6880),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);s.d(t,o);let d=["",{children:["dashboard",{children:["settings",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,1762)),"G:\\myaist\\AgentGuard\\packages\\dashboard\\src\\app\\dashboard\\settings\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,4341)),"G:\\myaist\\AgentGuard\\packages\\dashboard\\src\\app\\dashboard\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,7718)),"G:\\myaist\\AgentGuard\\packages\\dashboard\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,7824,23)),"next/dist/client/components/not-found-error"]}],c=["G:\\myaist\\AgentGuard\\packages\\dashboard\\src\\app\\dashboard\\settings\\page.tsx"],x="/dashboard/settings/page",g={require:s,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/dashboard/settings/page",pathname:"/dashboard/settings",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},4224:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,4424,23)),Promise.resolve().then(s.t.bind(s,7752,23)),Promise.resolve().then(s.t.bind(s,5275,23)),Promise.resolve().then(s.t.bind(s,9842,23)),Promise.resolve().then(s.t.bind(s,1633,23)),Promise.resolve().then(s.t.bind(s,9224,23))},682:(e,t,s)=>{Promise.resolve().then(s.bind(s,3658))},8144:()=>{},2684:(e,t,s)=>{Promise.resolve().then(s.bind(s,1394)),Promise.resolve().then(s.bind(s,8946))},3658:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var a=s(3227),r=s(3677),n=s(7674);function l(){let[e,t]=(0,r.useState)({}),[s,l]=(0,r.useState)(!1),[d,c]=(0,r.useState)(""),[x,g]=(0,r.useState)(""),[u,h]=(0,r.useState)(!1),[p,m]=(0,r.useState)({current:"",next:"",confirm:""}),[b,y]=(0,r.useState)(""),[f,v]=(0,r.useState)([]),[j,N]=(0,r.useState)({alias:"",target_url:""}),[w,S]=(0,r.useState)(null);async function _(){t(await (0,n.SC)("/settings")),v((await (0,n.SC)("/service-aliases")).aliases)}async function P(){await (0,n.SC)("/settings",{method:"PUT",body:JSON.stringify(e)}),l(!0),setTimeout(()=>l(!1),2e3)}async function C(){g("");try{let e=await (0,n.SC)("/license/activate",{method:"POST",body:JSON.stringify({key:d})});g(`✓ ${e.message}（${e.plan}）`),h(!0),_()}catch(e){g(`✗ ${e.message}`),h(!1)}}async function k(){if(y(""),p.next!==p.confirm){y("两次密码不一致");return}try{await (0,n.SC)("/auth/change-password",{method:"POST",body:JSON.stringify({current:p.current,next:p.next})}),y("✓ 密码已更新"),m({current:"",next:"",confirm:""})}catch(e){y(`✗ ${e.message}`)}}async function G(){j.alias&&j.target_url&&(await (0,n.SC)("/service-aliases",{method:"POST",body:JSON.stringify(j)}),N({alias:"",target_url:""}),_())}async function A(e){await (0,n.SC)(`/service-aliases/${e}`,{method:"DELETE"}),_()}return(0,a.jsxs)("div",{className:"space-y-8 max-w-2xl",children:[a.jsx("h1",{className:"text-xl font-semibold text-white",children:"设置"}),a.jsx(i,{title:"授权与版本",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 text-sm",children:[a.jsx("span",{className:"text-gray-400",children:"当前版本"}),a.jsx("span",{className:"text-white font-medium capitalize",children:e.license_tier??"free"}),a.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${"active"===e.license_status?"bg-green-900/50 text-green-400":"bg-gray-800 text-gray-500"}`,children:"active"===e.license_status?"已激活":"未激活"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[a.jsx("input",{value:d,onChange:e=>c(e.target.value),placeholder:"AG-XXXX-XXXX-XXXX-XXXX",className:"flex-1 bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white text-sm font-mono focus:outline-none focus:border-blue-500"}),a.jsx("button",{onClick:C,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm",children:"激活"})]}),x&&a.jsx("p",{className:`text-xs ${u?"text-green-400":"text-red-400"}`,children:x})]})}),a.jsx(i,{title:"安全认证",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"会话超时（分钟）"}),a.jsx("input",{value:e.dashboard_session_timeout??"1440",onChange:e=>t(t=>({...t,dashboard_session_timeout:e.target.value})),type:"number",className:"w-32 bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white text-sm focus:outline-none"})]}),(0,a.jsxs)("div",{className:"border-t border-gray-800 pt-3 space-y-2",children:[a.jsx("p",{className:"text-xs text-gray-400 font-medium",children:"修改 Dashboard 密码"}),a.jsx("input",{value:p.current,onChange:e=>m(t=>({...t,current:e.target.value})),type:"password",placeholder:"当前密码",className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white text-sm focus:outline-none"}),a.jsx("input",{value:p.next,onChange:e=>m(t=>({...t,next:e.target.value})),type:"password",placeholder:"新密码",className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white text-sm focus:outline-none"}),a.jsx("input",{value:p.confirm,onChange:e=>m(t=>({...t,confirm:e.target.value})),type:"password",placeholder:"确认新密码",className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white text-sm focus:outline-none"}),a.jsx("button",{onClick:k,className:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg text-sm",children:"更新密码"}),b&&a.jsx("p",{className:`text-xs ${b.startsWith("✓")?"text-green-400":"text-red-400"}`,children:b})]})]})}),a.jsx(i,{title:"代理配置",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"代理端口"}),a.jsx("input",{value:e.proxy_port??"8080",onChange:e=>t(t=>({...t,proxy_port:e.target.value})),type:"number",className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white text-sm focus:outline-none"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"绑定地址"}),a.jsx("input",{value:e.proxy_bind??"127.0.0.1",onChange:e=>t(t=>({...t,proxy_bind:e.target.value})),className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white text-sm focus:outline-none"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"IP 白名单（逗号分隔，留空不限制）"}),a.jsx("input",{value:e.proxy_ip_whitelist??"",onChange:e=>t(t=>({...t,proxy_ip_whitelist:e.target.value})),placeholder:"127.0.0.1,192.168.1.0/24",className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white text-sm focus:outline-none"})]})]})}),a.jsx(i,{title:"服务别名",children:(0,a.jsxs)("div",{className:"space-y-3",children:[a.jsx("div",{className:"space-y-2",children:f.map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-3 text-sm",children:[a.jsx("code",{className:"text-blue-400 w-28 shrink-0",children:e.alias}),a.jsx("span",{className:"text-gray-400 flex-1 truncate",children:e.target_url}),e.builtin?a.jsx("span",{className:"text-xs text-gray-600",children:"内置"}):a.jsx("button",{onClick:()=>A(e.id),className:"text-xs text-red-500 hover:text-red-400",children:"删除"})]},e.id))}),(0,a.jsxs)("div",{className:"flex gap-2 pt-2 border-t border-gray-800",children:[a.jsx("input",{value:j.alias,onChange:e=>N(t=>({...t,alias:e.target.value})),placeholder:"别名 (如 my-api)",className:"w-32 bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white text-sm focus:outline-none"}),a.jsx("input",{value:j.target_url,onChange:e=>N(t=>({...t,target_url:e.target.value})),placeholder:"目标 URL (如 https://api.example.com)",className:"flex-1 bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white text-sm focus:outline-none"}),a.jsx("button",{onClick:G,className:"bg-gray-700 hover:bg-gray-600 text-white px-3 py-2 rounded-lg text-sm",children:"添加"})]})]})}),a.jsx(i,{title:"数据管理",children:a.jsx("div",{className:"space-y-3",children:(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"日志保留天数"}),a.jsx("input",{value:e.log_retention_days??"7",onChange:e=>t(t=>({...t,log_retention_days:e.target.value})),type:"number",min:"1",max:"365",className:"w-32 bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white text-sm focus:outline-none"})]})})}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("button",{onClick:P,className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg text-sm font-medium",children:"保存设置"}),s&&a.jsx("span",{className:"text-green-400 text-sm",children:"✓ 已保存"})]}),a.jsx(i,{title:"危险操作",danger:!0,children:(0,a.jsxs)("div",{className:"space-y-3",children:[a.jsx(o,{label:"清空所有日志",confirm:"确认清空所有请求日志？此操作不可恢复。",onClick:async()=>{await (0,n.SC)("/settings/clear-logs",{method:"POST"}),alert("日志已清空")}}),a.jsx(o,{label:"重置所有规则",confirm:"确认重置所有规则为默认值？",onClick:async()=>{await (0,n.SC)("/settings/reset-rules",{method:"POST"}),alert("规则已重置")}})]})})]})}function i({title:e,children:t,danger:s}){return(0,a.jsxs)("div",{className:`bg-gray-900 border rounded-xl p-5 space-y-4 ${s?"border-red-900/50":"border-gray-800"}`,children:[a.jsx("h2",{className:`text-sm font-medium ${s?"text-red-400":"text-gray-300"}`,children:e}),t]})}function o({label:e,confirm:t,onClick:s}){return a.jsx("button",{onClick:()=>{window.confirm(t)&&s()},className:"text-sm text-red-400 hover:text-red-300 bg-red-900/20 hover:bg-red-900/40 px-4 py-2 rounded-lg border border-red-900/50",children:e})}},1394:(e,t,s)=>{"use strict";s.d(t,{default:()=>d});var a=s(3227),r=s(649),n=s(1043),l=s(7674),i=s(1126);let o=[{href:"/dashboard",label:"总览",icon:"◉"},{href:"/dashboard/agents",label:"Agent",icon:"⬡"},{href:"/dashboard/rules",label:"规则",icon:"⚙"},{href:"/dashboard/logs",label:"日志",icon:"≡"},{href:"/dashboard/alerts",label:"告警",icon:"⚠"},{href:"/dashboard/settings",label:"设置",icon:"⊙"}];function d(){let e=(0,n.usePathname)();return(0,a.jsxs)("aside",{className:"w-52 shrink-0 bg-gray-900 border-r border-gray-800 flex flex-col min-h-screen",children:[(0,a.jsxs)("div",{className:"px-4 py-5 border-b border-gray-800",children:[a.jsx("span",{className:"font-bold text-white text-lg",children:"AgentGuard"}),a.jsx("span",{className:"ml-2 text-xs text-gray-500",children:"v1.0"})]}),a.jsx("nav",{className:"flex-1 py-4 space-y-1 px-2",children:o.map(t=>(0,a.jsxs)(r.default,{href:t.href,className:(0,i.Z)("flex items-center gap-3 px-3 py-2 rounded-lg text-sm transition-colors",e===t.href?"bg-blue-600 text-white":"text-gray-400 hover:text-white hover:bg-gray-800"),children:[a.jsx("span",{children:t.icon}),a.jsx("span",{children:t.label})]},t.href))}),a.jsx("div",{className:"p-4 border-t border-gray-800",children:a.jsx("button",{onClick:l.kS,className:"w-full text-left text-xs text-gray-500 hover:text-gray-300 transition-colors",children:"退出登录"})})]})}},8946:(e,t,s)=>{"use strict";s.d(t,{default:()=>l});var a=s(3227),r=s(3677),n=s(7674);function l(){let[e,t]=(0,r.useState)({global:{paused:!1}}),[s,l]=(0,r.useState)(!1);async function i(){if(e.global.paused)await (0,n.SC)("/kill-switch/deactivate",{method:"POST",body:JSON.stringify({scope:"global"})}),t({global:{paused:!1}});else{if(!s){l(!0);return}await (0,n.SC)("/kill-switch/activate",{method:"POST",body:JSON.stringify({reason:"手动触发",scope:"global"})}),t({global:{paused:!0}}),l(!1)}}return(0,a.jsxs)("header",{className:"h-14 bg-gray-900 border-b border-gray-800 flex items-center justify-between px-6 shrink-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:`w-2 h-2 rounded-full ${e.global.paused?"bg-red-500":"bg-green-500"}`}),a.jsx("span",{className:"text-sm text-gray-400",children:e.global.paused?"已暂停":"运行中"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[s&&a.jsx("span",{className:"text-xs text-yellow-400",children:"再次点击确认暂停所有请求"}),a.jsx("button",{onClick:i,onBlur:()=>l(!1),className:`px-4 py-1.5 rounded-lg text-sm font-medium transition-colors ${e.global.paused?"bg-green-700 hover:bg-green-600 text-white":s?"bg-red-500 hover:bg-red-400 text-white":"bg-red-900 hover:bg-red-800 text-red-300"}`,children:e.global.paused?"▶ 恢复服务":"■ Kill Switch"})]})]})}},7674:(e,t,s)=>{"use strict";s.d(t,{SC:()=>r,kS:()=>n});let a=process.env.NEXT_PUBLIC_API_URL||"/api";async function r(e,t){let s=await fetch(`${a}${e}`,{...t,headers:{"Content-Type":"application/json",...t?.headers}});if(401===s.status)throw Error("Unauthorized");if(!s.ok)throw Error((await s.json().catch(()=>({}))).message||`HTTP ${s.status}`);return s.json()}function n(){localStorage.removeItem("ag_token"),window.location.href="/login"}},4341:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var a=s(9013),r=s(3189);let n=(0,r.createProxy)(String.raw`G:\myaist\AgentGuard\packages\dashboard\src\components\Sidebar.tsx#default`),l=(0,r.createProxy)(String.raw`G:\myaist\AgentGuard\packages\dashboard\src\components\TopBar.tsx#default`);function i({children:e}){return(0,a.jsxs)("div",{className:"flex h-screen overflow-hidden",children:[a.jsx(n,{}),(0,a.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[a.jsx(l,{}),a.jsx("main",{className:"flex-1 overflow-y-auto p-6 bg-gray-950",children:e})]})]})}},1762:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(3189).createProxy)(String.raw`G:\myaist\AgentGuard\packages\dashboard\src\app\dashboard\settings\page.tsx#default`)},7718:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n,metadata:()=>r});var a=s(9013);s(5556);let r={title:"AgentGuard",description:"AI Agent API 安全代理网关"};function n({children:e}){return a.jsx("html",{lang:"zh-CN",children:a.jsx("body",{className:"bg-gray-950 text-gray-100 min-h-screen",children:e})})}},5556:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[592,914],()=>s(6938));module.exports=a})();