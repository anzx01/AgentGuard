(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[638],{7578:function(e,t,n){Promise.resolve().then(n.bind(n,9684))},4859:function(e,t,n){"use strict";var r,s;e.exports=(null==(r=n.g.process)?void 0:r.env)&&"object"==typeof(null==(s=n.g.process)?void 0:s.env)?n.g.process:n(9566)},9566:function(e){!function(){var t={229:function(e){var t,n,r,s=e.exports={};function a(){throw Error("setTimeout has not been defined")}function o(){throw Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===a||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:a}catch(e){t=a}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var l=[],c=!1,u=-1;function d(){c&&r&&(c=!1,r.length?l=r.concat(l):u=-1,l.length&&x())}function x(){if(!c){var e=i(d);c=!0;for(var t=l.length;t;){for(r=l,l=[];++u<t;)r&&r[u].run();u=-1,t=l.length}r=null,c=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function g(e,t){this.fun=e,this.array=t}function m(){}s.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new g(e,t)),1!==l.length||c||i(x)},g.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=m,s.addListener=m,s.once=m,s.off=m,s.removeListener=m,s.removeAllListeners=m,s.emit=m,s.prependListener=m,s.prependOnceListener=m,s.listeners=function(e){return[]},s.binding=function(e){throw Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw Error("process.chdir is not supported")},s.umask=function(){return 0}}},n={};function r(e){var s=n[e];if(void 0!==s)return s.exports;var a=n[e]={exports:{}},o=!0;try{t[e](a,a.exports,r),o=!1}finally{o&&delete n[e]}return a.exports}r.ab="//";var s=r(229);e.exports=s}()},9684:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var r=n(7573),s=n(7653),a=n(5118);function o(){let[e,t]=(0,s.useState)([]),[n,o]=(0,s.useState)(!1),[i,l]=(0,s.useState)({name:"",description:""}),[c,u]=(0,s.useState)(null),[d,x]=(0,s.useState)(!1),[g,m]=(0,s.useState)("");async function h(){t((await (0,a.SC)("/agents")).agents)}async function f(e){e.preventDefault(),x(!0),m("");try{let e=await (0,a.SC)("/agents",{method:"POST",body:JSON.stringify(i)});u(e.token),o(!1),l({name:"",description:""}),h()}catch(e){m(e.message)}finally{x(!1)}}async function p(e){let t="active"===e.status?"pause":"resume";await (0,a.SC)("/agents/".concat(e.id,"/").concat(t),{method:"POST"}),h()}async function b(e){confirm("确认删除此 Agent？")&&(await (0,a.SC)("/agents/".concat(e),{method:"DELETE"}),h())}async function y(e){u((await (0,a.SC)("/agents/".concat(e,"/rotate-token"),{method:"POST"})).token)}(0,s.useEffect)(()=>{h()},[]);let v={active:"bg-green-500",paused:"bg-yellow-500",blocked:"bg-red-500"};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h1",{className:"text-xl font-semibold text-white",children:"Agent 管理"}),(0,r.jsx)("button",{onClick:()=>o(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium",children:"+ 新建 Agent"})]}),c&&(0,r.jsxs)("div",{className:"bg-yellow-900/30 border border-yellow-700 rounded-xl p-4",children:[(0,r.jsx)("p",{className:"text-yellow-300 text-sm font-medium mb-2",children:"⚠ Agent Token（仅显示一次，请立即保存）"}),(0,r.jsx)("code",{className:"text-yellow-100 text-xs break-all bg-yellow-900/50 px-3 py-2 rounded block",children:c}),(0,r.jsx)("button",{onClick:()=>u(null),className:"mt-2 text-xs text-yellow-500 hover:text-yellow-300",children:"关闭"})]}),n&&(0,r.jsxs)("div",{className:"bg-gray-900 border border-gray-800 rounded-xl p-5",children:[(0,r.jsx)("h2",{className:"text-sm font-medium text-gray-300 mb-4",children:"新建 Agent"}),(0,r.jsxs)("form",{onSubmit:f,className:"space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs text-gray-400 mb-1",children:"名称 *"}),(0,r.jsx)("input",{value:i.name,onChange:e=>l(t=>({...t,name:e.target.value})),className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white text-sm focus:outline-none focus:border-blue-500",placeholder:"my-agent",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs text-gray-400 mb-1",children:"描述"}),(0,r.jsx)("input",{value:i.description,onChange:e=>l(t=>({...t,description:e.target.value})),className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-3 py-2 text-white text-sm focus:outline-none focus:border-blue-500",placeholder:"用途描述"})]}),g&&(0,r.jsx)("p",{className:"text-red-400 text-xs",children:g}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{type:"submit",disabled:d,className:"bg-blue-600 hover:bg-blue-700 disabled:opacity-50 text-white px-4 py-2 rounded-lg text-sm",children:d?"创建中...":"创建"}),(0,r.jsx)("button",{type:"button",onClick:()=>o(!1),className:"bg-gray-800 hover:bg-gray-700 text-gray-300 px-4 py-2 rounded-lg text-sm",children:"取消"})]})]})]}),0===e.length&&!n&&(0,r.jsxs)("div",{className:"text-center py-16 text-gray-500",children:[(0,r.jsx)("p",{className:"text-4xl mb-3",children:"⬡"}),(0,r.jsx)("p",{children:'暂无 Agent，点击"新建 Agent"开始'})]}),(0,r.jsx)("div",{className:"space-y-3",children:e.map(e=>{var t,n;return(0,r.jsxs)("div",{className:"bg-gray-900 border border-gray-800 rounded-xl p-5",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("span",{className:"w-2.5 h-2.5 rounded-full ".concat(null!==(t=v[e.status])&&void 0!==t?t:"bg-gray-500")}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium text-white",children:e.name}),e.description&&(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-0.5",children:e.description})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{onClick:()=>p(e),className:"text-xs px-3 py-1 rounded-lg bg-gray-800 hover:bg-gray-700 text-gray-300",children:"active"===e.status?"暂停":"恢复"}),(0,r.jsx)("button",{onClick:()=>y(e.id),className:"text-xs px-3 py-1 rounded-lg bg-gray-800 hover:bg-gray-700 text-gray-300",children:"重置 Token"}),(0,r.jsx)("button",{onClick:()=>b(e.id),className:"text-xs px-3 py-1 rounded-lg bg-red-900/50 hover:bg-red-900 text-red-400",children:"删除"})]})]}),(0,r.jsxs)("div",{className:"mt-3 flex items-center gap-4 text-xs text-gray-500",children:[(0,r.jsxs)("span",{children:["Token: ",(0,r.jsxs)("code",{className:"text-gray-400",children:[null!==(n=e.token_prefix)&&void 0!==n?n:"ag_live_","..."]})]}),(0,r.jsxs)("span",{children:["创建于 ",new Date(e.created_at).toLocaleDateString()]}),e.last_seen_at&&(0,r.jsxs)("span",{children:["最后活跃 ",new Date(e.last_seen_at).toLocaleString()]})]})]},e.id)})})]})}},5118:function(e,t,n){"use strict";n.d(t,{SC:function(){return s},jl:function(){return a},kS:function(){return o}});let r=n(4859).env.NEXT_PUBLIC_API_URL||"/api";async function s(e,t){let n=localStorage.getItem("ag_token"),s=await fetch("".concat(r).concat(e),{...t,headers:{"Content-Type":"application/json",...n?{Authorization:"Bearer ".concat(n)}:{},...null==t?void 0:t.headers}});if(401===s.status)throw localStorage.removeItem("ag_token"),window.location.href="/login",Error("Unauthorized");if(!s.ok)throw Error((await s.json().catch(()=>({}))).message||"HTTP ".concat(s.status));return s.json()}function a(){return!!localStorage.getItem("ag_token")}function o(){localStorage.removeItem("ag_token"),window.location.href="/login"}}},function(e){e.O(0,[293,528,744],function(){return e(e.s=7578)}),_N_E=e.O()}]);